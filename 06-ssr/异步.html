<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    function showLoadingScreen() {
      console.log('showLoadingScreen');
    }

    function hideLoadingScreen() {
      console.log('hideLoadingScreen');
    }

    function loadUIDataAsynchronously() {
      console.log('loadUIDataAsynchronously');
    }

    // Generator 函数的一个重要实际意义就是用来处理异步操作，改写回调函数。
    function* loadUI() {
      showLoadingScreen();
      yield loadUIDataAsynchronously();
      hideLoadingScreen();
    }
    var loader = loadUI();
    // 加载UI
    // loader.next()

    // 卸载UI
    // loader.next()



    // ajax
    // 请求AJAX函数
    function request(url) {
      fetch(url)
        .then((res) => {
          return res.json()
        }).then((json) => {
          console.log(json)
          // 这一步就是把结果赋值给了下面main里面的result
          //第一个yield前面的赋值是第二个next传递进去的参数
          it.next(JSON.stringify(json))
          /* 必须加上response参数，因为yield表达式，本身是没有值的，总是等于undefined。 */
        }).catch((e) => {
          console.log(e)
        })
    }
    // 把异步的代码用同步的方式表达
    function* main() {
      let result = yield request("http://www.qiuhang.club:7300/mock/5e1c648a059ebf2c630e5369/example/mock");
      let resp = JSON.parse(result);
      console.log(resp);
    }

    let it = main();
    it.next()
  </script>
</body>

</html>